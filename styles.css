.layout{display:block;padding:16px 18px 96px}
.content{padding:0}
:root{
  --bg:#0b0b0d; --panel:#131317; --muted:#101016; --text:#e6e6ec; --subtle:#a6a6b3; --primary:#7c5cff; --accent:#00d4ff; --error:#ff5c7c;
  --glass: rgba(255,255,255,0.04);
  --glass-border: rgba(255,255,255,0.08);
  --shadow: 0 10px 34px rgba(0,0,0,0.55);
}
*{box-sizing:border-box}
html,body,#app{height:100%}
body{margin:0;background:radial-gradient(1200px 800px at 80% -20%,rgba(124,92,255,.15),transparent),linear-gradient(180deg,#0b0b0d 0%, #0b0b0d 100%);color:var(--text);font:14px/1.5 Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;}

/* Global flow-paused visuals */
body.flow-paused::before{
  content:"";
  position:fixed; inset:0; z-index:6500;
  background:radial-gradient(1200px 800px at 50% -20%, rgba(124,92,255,0.05), transparent),
             rgba(10,10,14,0.35);
  backdrop-filter: blur(1.5px);
  pointer-events:none;
}
#pausedBanner{
  position:fixed; left:50%; top:10px; transform:translate(-50%, -8px);
  z-index:10050; opacity:0; transition:opacity .18s ease, transform .18s ease;
  padding:8px 12px; border-radius:10px;
  background:linear-gradient(180deg, rgba(124,92,255,0.10), rgba(0,212,255,0.06));
  border:1px solid rgba(124,92,255,0.25);
  color:#eaf6ff; font-weight:600; font-size:12px;
  box-shadow:0 10px 28px rgba(0,0,0,0.45);
  pointer-events:none;
}
body.flow-paused #pausedBanner{ opacity:1; transform:translate(-50%, 0); }

/* Layout */
#app{height:100%}
.brand{font-weight:700;letter-spacing:.5px;opacity:.9}
.subtle{color:var(--subtle);font-size:12px;margin-top:6px}
.row{display:flex;gap:8px;align-items:center;margin-top:8px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.label{font-size:12px;color:var(--subtle);margin:2px 0 6px}
.icon-btn{background:transparent;border:0;color:var(--subtle);cursor:pointer}
.btn{background:var(--glass);backdrop-filter: blur(6px);border:1px solid var(--glass-border);color:var(--text);padding:8px 10px;border-radius:10px;cursor:pointer}
.btn:hover{border-color:#3a3a45}
.btn-primary{background:linear-gradient(135deg,var(--primary),#5b38ff);border:0;color:#fff}
.btn-ghost{background:transparent;border:1px dashed #2a2a35;color:var(--subtle)}
.api-key-row{display:flex;gap:8px}
.badge{font-size:11px;padding:2px 8px;border-radius:999px;border:1px solid #2a2a35;background:#17171d;color:var(--subtle)}
.badge-ok{border-color:#284b2f;color:#a1e8b5;background:#0f1b13}
.badge-error{border-color:#4b2f34;color:#ffb3c2;background:#1b0f12}
.badge.saved{position:relative}
.badge.saved::after{content:"âœ“";position:absolute;right:-8px;top:-6px;background:#13b36b;color:#021;border-radius:10px;font-size:10px;padding:2px 4px;border:1px solid #0a7a4b;box-shadow:0 4px 12px rgba(0,0,0,.4)}
.avatar{display:none}
.hex-avatar{position:relative;width:20px;height:20px;display:grid;place-items:center}
.hex-avatar svg{width:100%;height:100%;display:block;margin:auto;filter:drop-shadow(0 4px 14px rgba(124,92,255,0.25))}
.hex-spin{animation:spin 1.2s linear infinite}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
.hex-notify{position:fixed;top:12px;right:12px;z-index:10000;display:flex;flex-direction:column;gap:6px;align-items:flex-end;max-width:320px}
.hex-bubble{background:rgba(0,164,255,0.06);border:1px solid rgba(0,164,255,0.20);color:#cfeaff;padding:8px 10px;border-radius:10px;box-shadow:0 8px 22px rgba(0,0,0,0.45);cursor:pointer;backdrop-filter: blur(8px)}
.hex-bubble.warn{background:rgba(0,164,255,0.06);border-color:rgba(0,164,255,0.22);color:#d6ecff}
.hex-bubble.error{background:#1b0f12;border-color:#4b2f34;color:#ffb3c2}
.hex-bubble.fade-out{opacity:0;transition:opacity .22s ease}
.settings{display:grid;gap:8px;margin:10px 0;position:sticky;top:48px;background:linear-gradient(180deg,#131317,#0f0f13);padding:8px;border-bottom:1px solid #23232b;z-index:1;border-radius:10px}
.settings.collapsed{display:none}
.settings label{display:grid;gap:6px;font-size:12px;color:var(--subtle)}
.settings input,.settings select, textarea{background:#0f0f14;border:1px solid #24242c;border-radius:8px;padding:8px;color:var(--text);outline:none}
.settings select{appearance:none}
.card{border:1px solid #23232b;background:linear-gradient(180deg,#121219,#0e0e14);border-radius:12px;padding:12px;margin-top:12px;box-shadow:var(--shadow)}
.list{display:flex;flex-direction:column;gap:8px}
.chip{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;border-radius:999px;border:1px solid #2a2a35;background:#141419;color:var(--subtle);font-size:11px;margin:4px 0}

/* Main board */
/* App bar */
.appbar{position:sticky;top:0;z-index:30;background:linear-gradient(180deg,#101015,#0c0c10);border-bottom:1px solid #23232b;box-shadow:var(--shadow)}
.appbar-inner{display:flex;align-items:center;gap:12px;justify-content:space-between;padding:10px 14px}
.brand{display:flex;align-items:center;gap:8px}
.logo{width:18px;height:18px;border:1.8px solid var(--accent);clip-path:polygon(50% 0%, 93% 25%, 93% 75%, 50% 100%, 7% 75%, 7% 25%)}
.search{display:flex;align-items:center;gap:8px;background:#0f0f14;border:1px solid #24242c;border-radius:999px;padding:6px 10px;min-width:260px}
.search input{background:transparent;border:0;outline:0;color:var(--text);width:100%}

/* Content panels */
.content{padding:16px 18px 96px}
.panel{border:1px solid #23232b;background:linear-gradient(180deg,#121219,#0e0e14);border-radius:12px;box-shadow:var(--shadow);margin-bottom:12px}
.panel .head{display:flex;align-items:baseline;gap:10px;padding:10px 12px;border-bottom:1px solid #23232b}
.panel .head h2{margin:0;font-size:16px}
.panel .body{padding:12px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width: 900px){.grid{grid-template-columns:1fr}}
.card-item{border:1px solid #23232b;background:#0f0f14;border-radius:12px;padding:10px}
.card-item .title{font-weight:600;margin-bottom:6px;color:var(--subtle)}
.card-item .html-box{max-height:220px}

/* Dropzones & file lists */
.dropzone{margin-top:8px;border:1px dashed #2a2a35;border-radius:10px;padding:14px;text-align:center;color:var(--subtle);background:#0f0f14}
.dropzone.drag{border-color:var(--accent);color:#cfeaff;background:rgba(0,212,255,0.04)}
.file-list{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.file-chip{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border:1px solid #2a2a35;border-radius:999px;background:#141419;color:var(--subtle);font-size:12px}

/* Chat drop highlight */
#messages.drag, #userInput.drag {
  outline: 2px dashed var(--accent);
  outline-offset: 4px;
}

/* Attachments bar */
.attachments{display:flex;flex-wrap:wrap;gap:6px;padding:8px;border-top:1px solid #20202a;border-bottom:1px solid #20202a;background:#101016}
.attachments.hidden{display:none}
.attachment-chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid #2a2a35;border-radius:999px;background:#16161d;color:#cfd3e3;font-size:12px}
.attachment-chip .name{max-width:260px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.attachment-chip .rm{cursor:pointer;border:none;background:transparent;color:#9aa3b2;font-weight:700}
.attachment-chip .rm:hover{color:#e05a6f}
.file-chip .x{cursor:pointer;color:#888}

/* Inputs */
.input-label{display:block;margin:12px 0 6px;font-size:13px;color:#cbd5e1}
.text-input{width:100%;background:#0b1220;border:1px solid #1f2a44;border-radius:8px;color:#e2e8f0;padding:10px 12px;outline:none}
.text-input:focus{border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.2)}

/* Floating action buttons */
.fab{position:fixed;bottom:18px;z-index:9000;border-radius:999px;padding:10px 12px;min-width:40px;min-height:40px;background:linear-gradient(135deg,#14141a,#111116);color:var(--text);border:1px solid #23232b;box-shadow:var(--shadow);cursor:grab;display:inline-flex;align-items:center;justify-content:center;user-select:none;touch-action:none;-webkit-user-drag:none}
.fab *{pointer-events:none}
.fab:active{cursor:grabbing}
.panel-drawer.show.right ~ .fab.fab-right{bottom:76px}
/* .fab-left removed */
.fab-right{right:18px}
.fab .hex-mini{width:20px;height:20px;display:block;filter:drop-shadow(0 2px 8px rgba(124,92,255,0.25))}
.fab .fab-text{vertical-align:middle}

/* Label that appears above each FAB showing copilot name */
.fab-label{position:absolute;left:50%;top:-28px;transform:translateX(-50%);white-space:nowrap;padding:4px 8px;border-radius:8px;background:linear-gradient(180deg, rgba(124,92,255,0.06), rgba(0,212,255,0.03));color:#eaf6ff;font-weight:600;font-size:12px;box-shadow:0 6px 20px rgba(0,212,255,0.06);text-shadow:0 2px 10px rgba(124,92,255,0.18);pointer-events:none}
.fab-label::after{content:'';position:absolute;left:50%;bottom:-6px;transform:translateX(-50%);width:10px;height:6px;background:linear-gradient(180deg, rgba(124,92,255,0.06), rgba(0,212,255,0.03));border-radius:2px}

/* Center + button to add copilot instances */
.copilot-plus{position:fixed;left:50%;top:58px;transform:translateX(-50%);z-index:7000;width:40px;height:40px;border-radius:999px;border:1px dashed #2a2a35;background:#0f0f14;color:#cfd3e3;box-shadow:var(--shadow);cursor:pointer}
.copilot-plus:hover{border-color:#3a3a45}

/* Floating Copilot flyout for instances */
.panel-flyout{position:fixed;z-index:8000;width:min(92vw, 420px);max-width:92vw;max-height:85vh;display:flex;flex-direction:column;background:linear-gradient(180deg,var(--panel),#0f0f13);border:1px solid #23232b;border-radius:12px;box-shadow:0 18px 48px rgba(0,0,0,0.6);opacity:0;transform:scale(.85);transition:opacity .22s ease, transform .22s cubic-bezier(.18,.7,.2,1.02);pointer-events:none}
.panel-flyout.show{opacity:1;transform:scale(1);pointer-events:auto}
.panel-flyout.hidden{display:none}
.panel-flyout .drawer-head{display:flex;align-items:center;gap:10px;padding:12px;border-bottom:1px solid #23232b}
.panel-flyout .drawer-head[data-role="dragHandle"]{cursor:move}
.panel-flyout .messages{padding:14px;overflow:auto;flex:1}
.panel-flyout .composer{display:flex;gap:8px;padding:14px;background:linear-gradient(180deg,#0f0f13,#0c0c10);border-top:1px solid #23232b;border-bottom-left-radius:12px;border-bottom-right-radius:12px}
.panel-flyout .author-label{padding:4px 14px 0 14px;font-size:12px;color:var(--subtle)}
.panel-flyout .settings{display:grid;gap:8px;margin:10px;border-bottom:1px solid #23232b;background:linear-gradient(180deg,#131317,#0f0f13);padding:8px;border-radius:10px;max-height:min(50vh, 420px);overflow:auto;overscroll-behavior:contain}
.panel-flyout .settings.collapsed{display:none}
.panel-flyout .settings label{display:grid;gap:6px;font-size:12px;color:var(--subtle)}
.panel-flyout .settings input,.panel-flyout .settings select, .panel-flyout textarea{background:#0f0f14;border:1px solid #24242c;border-radius:8px;padding:8px;color:var(--text);outline:none}
.panel-flyout .settings::-webkit-scrollbar{width:10px}
.panel-flyout .settings::-webkit-scrollbar-thumb{background:#1b1b24;border-radius:10px}
.flyout-resize{position:absolute;width:14px;height:14px}
.flyout-resize.br{right:6px;bottom:6px;cursor:nwse-resize;background:linear-gradient(135deg,transparent 50%, rgba(124,92,255,.4) 50%);clip-path:polygon(0 100%, 100% 0, 100% 100%);opacity:.6}
.flyout-resize.br:hover{opacity:1}
.flyout-resize.t{top:-2px;left:0;right:0;height:6px;width:auto;cursor:ns-resize;background:transparent}
.flyout-resize.b{bottom:-2px;left:0;right:0;height:6px;width:auto;cursor:ns-resize;background:transparent}
.flyout-resize.l{left:-2px;top:0;bottom:0;width:6px;height:auto;cursor:ew-resize;background:transparent}
.flyout-resize.r{right:-2px;top:0;bottom:0;width:6px;height:auto;cursor:ew-resize;background:transparent}

/* Drawers */
.panel-drawer{position:fixed;top:0;bottom:0;width:360px;max-width:92vw;min-width:280px;background:linear-gradient(180deg,var(--panel),#0f0f13);border:1px solid #23232b;box-shadow:var(--shadow);z-index:40;display:flex;flex-direction:column;transition:transform .3s cubic-bezier(.18,.7,.2,1.02), opacity .25s ease}
.panel-drawer.right{right:0;transform:translateX(100%) scale(.85)}
/* .panel-drawer.left removed */
.panel-drawer.show.right{transform:translateX(0) scale(1)}
/* .panel-drawer.show.left removed */
.panel-drawer .drawer-head{display:flex;align-items:center;gap:10px;padding:12px;border-bottom:1px solid #23232b}
.panel-drawer .menu-body{padding:12px;overflow:auto}
/* Resize handle */
.drawer-resize-handle{position:absolute;top:0;bottom:0;width:6px;cursor:ew-resize;background:transparent}
.drawer-resize-handle.left{left:-3px}
.drawer-resize-handle.right{right:-3px}
.drawer-resize-handle:hover{background:linear-gradient(180deg, rgba(124,92,255,0.18), rgba(0,212,255,0.18))}

/* Spawn-from-button effect (scale from near FAB corner) */
.panel-drawer{opacity:0}
.panel-drawer.from-right{transform-origin: calc(100% - 18px) calc(100% - 18px)}
.panel-drawer.from-left{transform-origin: 18px calc(100% - 18px)}
.panel-drawer.show{opacity:1}

/* Chat in drawer */
.messages{padding:14px;overflow:auto;flex:1}
.panel-flyout .attachments{margin:0 14px 6px;border-radius:10px}
.panel-flyout.user-node-panel .attachments{margin:0 14px 6px}
.composer{display:flex;gap:8px;padding:14px;background:linear-gradient(180deg,#0f0f13,#0c0c10);border-top:1px solid #23232b;position:relative;border-bottom-left-radius:12px;border-bottom-right-radius:12px}
/* Leave room for the floating copilot FAB on the right */
.panel-drawer.right .composer{padding-right:96px}
@media (max-width: 480px){.panel-drawer.right .composer{padding-right:110px}}
#userInput{flex:1;background:#0f0f14;border:1px solid #24242c;border-radius:12px;padding:10px 12px;color:var(--text);resize:none;min-height:40px;max-height:300px;overflow:hidden}
.send-btn{background:linear-gradient(135deg,var(--primary),#5b38ff);border:0;border-radius:999px;color:white;padding:0 16px;cursor:pointer;align-self:flex-end;margin-bottom:6px;z-index:55;position:relative}

/* Bubbles */
.bubble{max-width:78%;padding:10px 12px;border-radius:16px;margin:8px 0;background:rgba(255,255,255,0.01);backdrop-filter: blur(10px);border:1px solid rgba(255,255,255,0.08);box-shadow:0 10px 26px rgba(0,0,0,0.35)}
.bubble.user{margin-left:auto;background:rgba(124,92,255,0.02);border-color:rgba(124,92,255,0.22)}
.assistant{margin:8px 0;max-width:92%;padding:8px 0;color:var(--text);opacity:.95;white-space:normal}
.assistant.typing{position:relative}
.assistant.typing:after{content:"";display:inline-block;width:8px;height:1em;background:linear-gradient(90deg, rgba(124,92,255,0.8), rgba(0,212,255,0.8));margin-left:4px;vertical-align:baseline;animation:blink .8s step-end infinite}
@keyframes blink{50%{opacity:0}}
/* Markdown content inside assistant */
.assistant p{margin:0 0 8px}
.assistant ul,.assistant ol{margin:6px 0 10px;padding-left:20px}
.assistant li{margin:2px 0}
.assistant a{color:#9ecbff;text-decoration:none;border-bottom:1px dotted #2a2a35}
.assistant a:hover{color:#cfeaff;border-bottom-color:#3a3a45}
.assistant code{background:#0f0f14;border:1px solid #23232b;border-radius:6px;padding:2px 4px}
.assistant pre{background:#0f0f14;border:1px solid #23232b;border-radius:8px;overflow:auto}
.assistant pre code{display:block;padding:10px;border:0;background:transparent}

/* Message author label inside bubbles */
.msg-author{font-size:11px;color:var(--subtle);margin-bottom:4px}
.assistant .msg-text, .bubble.user .msg-text{white-space:pre-wrap}

/* Exam rendering */
.exam{padding:12px;max-height:70vh;overflow:auto}
.exam-q{border-top:1px dashed #2a2a35;padding-top:8px;margin-top:8px}
.exam-q-title{font-weight:600;color:var(--subtle);margin-bottom:4px}
.exam-q-title .btn{margin-left:8px;padding:2px 8px;font-size:12px}
.exam-q-body{margin-top:6px}
.html-box{background:#0f0f14;border:1px solid #23232b;border-radius:8px;padding:8px;max-height:240px;overflow:auto}
.exam-sec-title{font-weight:600;margin:6px 0 2px}

/* Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:6000}
.modal.hidden{display:none}
.modal-content{width:min(1000px,92vw);max-height:88vh;background:linear-gradient(180deg,var(--panel),#0f0f13);border:1px solid #23232b;border-radius:12px;box-shadow:var(--shadow);display:flex;flex-direction:column}

/* Scrollbar */
.messages::-webkit-scrollbar{width:10px}
.messages::-webkit-scrollbar-thumb{background:#1b1b24;border-radius:10px}

/* Connection overlay and points */
svg#connLayer{position:fixed;inset:0;width:100vw;height:100vh;pointer-events:none;z-index:7500}
.panel-flyout .conn-point{position:absolute;width:12px;height:12px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff, #cde, #79f);border:2px solid #4a79ff;box-shadow:0 0 6px rgba(74,121,255,0.35);transform:translate(-50%, -50%);cursor:crosshair}
.panel-flyout .conn-point.io-in{border-color:#22c55e;box-shadow:0 0 8px rgba(34,197,94,0.6)}
.panel-flyout .conn-point.io-out{border-color:#8b5cf6;box-shadow:0 0 8px rgba(139,92,246,0.6)}
.panel-flyout .conn-point:hover::after,
.fab .conn-point:hover::after,
.user-node-panel .conn-point:hover::after{
  position:absolute; top:-26px; left:50%; transform:translateX(-50%);
  background:linear-gradient(180deg,#14141a,#0f0f13);
  border:1px solid #2a2a35; color:#cfd3e3; font-size:11px;
  padding:3px 6px; border-radius:6px; white-space:nowrap; pointer-events:none;
  box-shadow:0 8px 20px rgba(0,0,0,0.45); z-index:7700;
}
.panel-flyout .conn-point.io-in:hover::after,
.fab .conn-point.io-in:hover::after,
.user-node-panel .conn-point.io-in:hover::after{ content:'Input'; }
.panel-flyout .conn-point.io-out:hover::after,
.fab .conn-point.io-out:hover::after,
.user-node-panel .conn-point.io-out:hover::after{ content:'Output'; }
.panel-flyout .conn-point[data-side="t"]{left:50%;top:-2px}
.panel-flyout .conn-point[data-side="b"]{left:50%;bottom:-2px;transform:translate(-50%, 50%)}
.panel-flyout .conn-point[data-side="l"]{top:50%;left:-2px}
.panel-flyout .conn-point[data-side="r"]{top:50%;right:-2px;transform:translate(50%, -50%)}
.panel-flyout .conn-point.hover{border-color:#00d4ff;box-shadow:0 0 10px rgba(0,212,255,0.6)}
.fab .conn-point{position:absolute;width:10px;height:10px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff, #cde, #79f);border:2px solid #4a79ff;box-shadow:0 0 6px rgba(74,121,255,0.35);transform:translate(-50%, -50%);cursor:crosshair}
.fab .conn-point.io-in{border-color:#22c55e;box-shadow:0 0 8px rgba(34,197,94,0.6)}
.fab .conn-point.io-out{border-color:#8b5cf6;box-shadow:0 0 8px rgba(139,92,246,0.6)}
.fab .conn-point{pointer-events:auto}
.fab .conn-point[data-side="t"]{left:50%;top:-2px}
.fab .conn-point[data-side="b"]{left:50%;bottom:-2px;transform:translate(-50%, 50%)}
.fab .conn-point[data-side="l"]{top:50%;left:-2px}
.fab .conn-point[data-side="r"]{top:50%;right:-2px;transform:translate(50%, -50%)}
.fab .conn-point.hover{border-color:#00d4ff;box-shadow:0 0 10px rgba(0,212,255,0.6)}
.panel-flyout.active-speaking{box-shadow:0 0 0 2px rgba(0,212,255,0.8), 0 0 32px rgba(0,212,255,0.25)}

/* Busy glow states for panels and FABs */
.panel-flyout.busy{
  box-shadow:
    0 0 0 2px rgba(124,92,255,0.75),
    0 0 26px rgba(124,92,255,0.35),
    0 0 46px rgba(0,212,255,0.28);
  border-color: rgba(124,92,255,0.6);
  animation: glowPulse 1.2s ease-in-out infinite;
}
.fab.busy{
  box-shadow:
    0 0 0 2px rgba(124,92,255,0.75),
    0 0 22px rgba(124,92,255,0.35),
    0 0 44px rgba(0,212,255,0.25);
  border-color: rgba(124,92,255,0.6);
  animation: glowPulse 1.2s ease-in-out infinite;
}
@keyframes glowPulse{
  0%{ box-shadow: 0 0 0 2px rgba(124,92,255,0.65), 0 0 18px rgba(124,92,255,0.28), 0 0 36px rgba(0,212,255,0.2); }
  50%{ box-shadow: 0 0 0 2px rgba(124,92,255,0.9), 0 0 30px rgba(124,92,255,0.45), 0 0 60px rgba(0,212,255,0.35); }
  100%{ box-shadow: 0 0 0 2px rgba(124,92,255,0.65), 0 0 18px rgba(124,92,255,0.28), 0 0 36px rgba(0,212,255,0.2); }
}

/* FAB context menu */
.fab-menu{position:fixed;z-index:9200;min-width:160px;max-width:280px;background:linear-gradient(180deg,#14141a,#0f0f13);border:1px solid #2a2a35;border-radius:10px;box-shadow:0 14px 44px rgba(0,0,0,0.6);padding:10px;display:none}
.fab-menu.show{display:block}
.fab-menu .fab-menu-row{display:flex;gap:8px}
.fab-menu button{background:transparent;border:1px dashed #2a2a35;color:#cfd3e3;font-size:13px;padding:8px 10px;border-radius:8px;cursor:pointer}
.fab-menu button:hover{border-color:#3a3a45}
.fab-menu button.danger{color:#ffb3c2;border-color:rgba(255,92,124,0.16)}

/* Connection hover menu */
.conn-menu{position:absolute;z-index:7600;background:linear-gradient(180deg,#14141a,#0f0f13);border:1px solid #2a2a35;border-radius:8px;box-shadow:0 10px 28px rgba(0,0,0,0.55);padding:6px;display:none}
.conn-menu.show{display:block}
.conn-menu button{background:transparent;border:1px dashed #2a2a35;color:#cfd3e3;font-size:12px;padding:6px 10px;border-radius:8px;cursor:pointer}
.conn-menu button:hover{border-color:#3a3a45}

/* Citations block */
.assistant.cites{opacity:.95}
.assistant.cites .msg-author{font-weight:600;margin-bottom:4px}
.assistant.cites .msg-text a{color:#9ecbff;text-decoration:none;margin-right:8px;border-bottom:1px dotted #2a2a35}
.assistant.cites .msg-text a:hover{color:#cfeaff;border-bottom-color:#3a3a45}

/* Internet hub (globe) */
.internet-hub{width:48px;height:48px;border-radius:50%;display:grid;place-items:center}
.internet-hub .globe{width:26px;height:26px;filter:drop-shadow(0 2px 10px rgba(124,92,255,0.35))}
.internet-hub.active{box-shadow:0 0 0 2px rgba(0,212,255,0.8), 0 0 36px rgba(0,212,255,0.35)}

/* User Node */
.user-node.fab{width:56px;height:56px;position:fixed;border-radius:50%;background:var(--panel);box-shadow:0 6px 18px rgba(0,0,0,0.25);display:inline-flex;align-items:center;justify-content:center;color:var(--text);z-index:9000}
.user-node .user-dot{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,#0ea5e9,#34d399)}
.user-node .fab-label{top:-20px}
.user-node-panel{position:fixed;min-width:280px;min-height:200px;background:var(--panel);border:1px solid var(--border, #23232b);border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.35);z-index:8200;opacity:0;transform:scale(.85);transition:opacity .18s ease, transform .18s ease;pointer-events:none}
.user-node-panel.show{opacity:1;transform:scale(1);pointer-events:auto}
.user-node-panel.hidden{display:none}
.user-node-panel .settings{padding:10px 12px;max-height:60vh;overflow:auto}
.user-node-panel .conn-point{position:absolute;width:10px;height:10px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff, #cde, #79f);border:2px solid #4a79ff;box-shadow:0 0 6px rgba(74,121,255,0.35);transform:translate(-50%, -50%)}
.user-node-panel .conn-point.io-in{border-color:#22c55e;box-shadow:0 0 8px rgba(34,197,94,0.6)}
.user-node-panel .conn-point.io-out{border-color:#8b5cf6;box-shadow:0 0 8px rgba(139,92,246,0.6)}
.user-node-panel .conn-point[data-side="t"]{left:50%;top:-2px}
.user-node-panel .conn-point[data-side="b"]{left:50%;bottom:-2px;transform:translate(-50%, 50%)}
.user-node-panel .conn-point[data-side="l"]{top:50%;left:-2px}
.user-node-panel .conn-point[data-side="r"]{top:50%;right:-2px;transform:translate(50%, -50%)}
.user-bubble{--user-bubble-bg:#0ea5e918;--user-bubble-fg:var(--text);font-family:var(--user-font,inherit)}
.user-bubble .msg-text{background:var(--user-bubble-bg);color:var(--user-bubble-fg);border-radius:10px;padding:8px 10px;display:inline-block}
